<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1&nbsp; Practical 1: Atmospheric state and forcings – Land-Atmosphere Interactions: Practicals</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./practical_2.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-2ef01e258a497a70032e58193e2c5164.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./practical_1.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Practical 1: Atmospheric state and forcings</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Land-Atmosphere Interactions: Practicals</a> 
        <div class="sidebar-tools-main">
    <a href="./Land-Atmosphere-Interactions--Practicals.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./practical_1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Practical 1: Atmospheric state and forcings</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./practical_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Practical 2: Role of land state and vegetation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#problem-1-observed-atmospheric-temperature-profile" id="toc-problem-1-observed-atmospheric-temperature-profile" class="nav-link active" data-scroll-target="#problem-1-observed-atmospheric-temperature-profile"><span class="header-section-number">1.1</span> Problem 1: Observed atmospheric temperature profile</a>
  <ul class="collapse">
  <li><a href="#task-a" id="toc-task-a" class="nav-link" data-scroll-target="#task-a"><span class="header-section-number">1.1.1</span> Task A</a></li>
  </ul></li>
  <li><a href="#problem-2" id="toc-problem-2" class="nav-link" data-scroll-target="#problem-2"><span class="header-section-number">1.2</span> Problem 2</a>
  <ul class="collapse">
  <li><a href="#task-a-1" id="toc-task-a-1" class="nav-link" data-scroll-target="#task-a-1"><span class="header-section-number">1.2.1</span> Task A</a></li>
  <li><a href="#task-b" id="toc-task-b" class="nav-link" data-scroll-target="#task-b"><span class="header-section-number">1.2.2</span> Task B</a></li>
  </ul></li>
  <li><a href="#problem-3" id="toc-problem-3" class="nav-link" data-scroll-target="#problem-3"><span class="header-section-number">1.3</span> Problem 3</a>
  <ul class="collapse">
  <li><a href="#task-a-2" id="toc-task-a-2" class="nav-link" data-scroll-target="#task-a-2"><span class="header-section-number">1.3.1</span> Task A</a></li>
  </ul></li>
  <li><a href="#description-of-the-changes-in-large-scale-atmospheric-forcing" id="toc-description-of-the-changes-in-large-scale-atmospheric-forcing" class="nav-link" data-scroll-target="#description-of-the-changes-in-large-scale-atmospheric-forcing"><span class="header-section-number">1.4</span> Description of the changes in large-scale atmospheric forcing</a></li>
  <li><a href="#sec-problem_4" id="toc-sec-problem_4" class="nav-link" data-scroll-target="#sec-problem_4"><span class="header-section-number">1.5</span> Problem 4</a>
  <ul class="collapse">
  <li><a href="#task-a-3" id="toc-task-a-3" class="nav-link" data-scroll-target="#task-a-3"><span class="header-section-number">1.5.1</span> Task A</a></li>
  <li><a href="#task-b-1" id="toc-task-b-1" class="nav-link" data-scroll-target="#task-b-1"><span class="header-section-number">1.5.2</span> Task B</a></li>
  <li><a href="#sec-feedback" id="toc-sec-feedback" class="nav-link" data-scroll-target="#sec-feedback"><span class="header-section-number">1.5.3</span> Task C</a></li>
  </ul></li>
  <li><a href="#sec-problem_5" id="toc-sec-problem_5" class="nav-link" data-scroll-target="#sec-problem_5"><span class="header-section-number">1.6</span> Problem 5</a>
  <ul class="collapse">
  <li><a href="#task-a-4" id="toc-task-a-4" class="nav-link" data-scroll-target="#task-a-4"><span class="header-section-number">1.6.1</span> Task A</a></li>
  <li><a href="#task-b-2" id="toc-task-b-2" class="nav-link" data-scroll-target="#task-b-2"><span class="header-section-number">1.6.2</span> Task B</a></li>
  <li><a href="#task-c" id="toc-task-c" class="nav-link" data-scroll-target="#task-c"><span class="header-section-number">1.6.3</span> Task C</a></li>
  </ul></li>
  <li><a href="#problem-6" id="toc-problem-6" class="nav-link" data-scroll-target="#problem-6"><span class="header-section-number">1.7</span> Problem 6</a>
  <ul class="collapse">
  <li><a href="#task-a-5" id="toc-task-a-5" class="nav-link" data-scroll-target="#task-a-5"><span class="header-section-number">1.7.1</span> Task A</a></li>
  <li><a href="#task-b-3" id="toc-task-b-3" class="nav-link" data-scroll-target="#task-b-3"><span class="header-section-number">1.7.2</span> Task B</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">1.8</span> Summary</a>
  <ul class="collapse">
  <li><a href="#task-a-6" id="toc-task-a-6" class="nav-link" data-scroll-target="#task-a-6"><span class="header-section-number">1.8.1</span> Task A</a></li>
  <li><a href="#task-b-4" id="toc-task-b-4" class="nav-link" data-scroll-target="#task-b-4"><span class="header-section-number">1.8.2</span> Task B</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-P1" class="quarto-section-identifier"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Practical 1: Atmospheric state and forcings</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Before conducting experiments with CLASS, you are first tasked to perform some introductory analysis on ABL theory.</p>
<section id="problem-1-observed-atmospheric-temperature-profile" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="problem-1-observed-atmospheric-temperature-profile"><span class="header-section-number">1.1</span> Problem 1: Observed atmospheric temperature profile</h2>
<p>The left panel of <a href="#fig-atm_profile" class="quarto-xref">Figure&nbsp;<span>1.1</span></a> illustrates a typical observed atmospheric temperature profile (red line) during the day with a well-mixed boundary layer formed as a result of daytime turbulent mixing. In the mixed ABL the temperature profile is nearly dry adiabatic, i.e.&nbsp;it closely follows the dry adiabatic lapse rate <span class="math inline">\(\Gamma_D \approx -10\)</span> K/km (see Theory L2.5). The ABL top is capped with a strong temperature inversion (increase of T with height).</p>
<div id="fig-atm_profile" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-atm_profile-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/observed_atmospheric_profile.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-atm_profile-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.1: Observed atmospheric profiles of absolute temperature (red line) and potential temperature (black line). Gray dashed lines indicate a temperature decrease corresponding to <span class="math inline">\(\Gamma_d\)</span>. Blue squares indicate two coordinates on the temperature profile selected for the exercises
</figcaption>
</figure>
</div>
<section id="task-a" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="task-a"><span class="header-section-number">1.1.1</span> Task A</h3>
<p>Find the temperature inversion on <a href="#fig-atm_profile" class="quarto-xref">Figure&nbsp;<span>1.1</span></a> below (left panel) and note down in the <a href="#tbl-atm_profile" class="quarto-xref">Table&nbsp;<span>1.1</span></a> the height (in pressure) of the ABL top and the absolute temperature (in Kelvin) corresponding to that ABL height. Also, identify the pressure and absolute temperature for the two air parcels, P1 and P2. Note, that in absolute terms, temperature in the atmosphere decreases with height, i.e <span class="math inline">\(T_2 &lt; T_{top,ABL} &lt; T_1\)</span>.</p>
<p>Based on the right pane of <a href="#fig-atm_profile" class="quarto-xref">Figure&nbsp;<span>1.1</span></a>, also fill in the potential temperature in the third column of <a href="#tbl-atm_profile" class="quarto-xref">Table&nbsp;<span>1.1</span></a></p>
<!--- Note that the jupyter conversion fails when you have empty cells in your table,
therefore fill it up using &#8203; (a zero width space) --->
<div id="tbl-atm_profile" class="striped quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-atm_profile-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1.1: Readings of atmospheric temperature profile <a href="#fig-atm_profile" class="quarto-xref">Figure&nbsp;<span>1.1</span></a>
</figcaption>
<div aria-describedby="tbl-atm_profile-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-striped caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>​</th>
<th><span class="math inline">\(P\)</span>: Pressure [hPa]</th>
<th><span class="math inline">\(T\)</span>: Absolute temperature [K]</th>
<th><span class="math inline">\(\theta\)</span>: Potential temperature read [K]</th>
<th><span class="math inline">\(\theta\)</span>: Potential temperature calculated [K]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>top, ABL</td>
<td></td>
<td>​</td>
<td>​</td>
<td></td>
</tr>
<tr class="even">
<td>Parcel P1</td>
<td></td>
<td>​</td>
<td>​</td>
<td></td>
</tr>
<tr class="odd">
<td>Parcel P2</td>
<td></td>
<td>​</td>
<td>​</td>
<td></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section>
</section>
<section id="problem-2" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="problem-2"><span class="header-section-number">1.2</span> Problem 2</h2>
<p>The concept of potential temperature takes into account effects of compression or expansion on air parcel’s temperature, and hence, allows for a comparison of a parcel’s buoyancy at any height. Use <a href="#eq-potential_temperature" class="quarto-xref">Equation&nbsp;<span>1.1</span></a> to calculate potential temperatures of the two parcels (P1 and P2) and the ABL top.</p>
<p><span id="eq-potential_temperature"><span class="math display">\[
\theta = T \left( \frac{p_0}{p} \right)^{R_d/c_p}
\tag{1.1}\]</span></span></p>
<p>Note that <span class="math inline">\(p_0\)</span> is the reference surface pressure of 1000 hPa, <span class="math inline">\(R_d = R/MW_{\text{dry,air}} = \frac{8.314 \text{ J/(K mol)}}{29e-3 \text{ kg/mol}} \approx 287 \text{ J/(K kg)}\)</span> the gas constant of dry air and <span class="math inline">\(c_p = 1013 \text{ J/(K kg)}\)</span> the specific heat of dry air at constant pressure. For the derivation of <a href="#eq-potential_temperature" class="quarto-xref">Equation&nbsp;<span>1.1</span></a>, the reader is referred to the supplementary material of Theory L2, more specifically to the section <em>Vertical pressure and temperature gradients</em> of <span class="citation" data-cites="Shuttleworh_terrestrial_hydromet">Shuttleworh (<a href="references.html#ref-Shuttleworh_terrestrial_hydromet" role="doc-biblioref">2012</a>)</span>.</p>
<p>Complete the fourth column of <a href="#tbl-atm_profile" class="quarto-xref">Table&nbsp;<span>1.1</span></a> with the three calculated <span class="math inline">\(\theta\)</span> values: at ABL height, and at parcels’ levels P1 and P2.</p>
<section id="task-a-1" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="task-a-1"><span class="header-section-number">1.2.1</span> Task A</h3>
<p>Now, imagine that you (dry adiabatically) descend parcels P1 and P2 down to the same level, for example the surface. Using the notion and formula of potential temperature, answer the question: which parcel will be warmer and more buoyant, P1 or P2?</p>
</section>
<section id="task-b" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="task-b"><span class="header-section-number">1.2.2</span> Task B</h3>
<p>Compare your findings with the profile of potential temperature in the right hand side of <a href="#fig-atm_profile" class="quarto-xref">Figure&nbsp;<span>1.1</span></a>. Explain now in your own words why it is said that the entrainment flux transports warmer air from the free troposphere (i.e.&nbsp;P2) down to the mixed ABL, even though absolute temperatures of free troposphere are colder than those of the ABL (i.e.&nbsp;<span class="math inline">\(T_2 &lt; T_{top,ABL} &lt; T_1\)</span>)?</p>
</section>
</section>
<section id="problem-3" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="problem-3"><span class="header-section-number">1.3</span> Problem 3</h2>
<p>Surface turbulent fluxes, <span class="math inline">\((\overline{w'\theta'})_s\)</span> and <span class="math inline">\((\overline{w'q'})_s\)</span>, are called eddy-covariance fluxes, because they can be estimated as the amount of common variation between temperature and vertical velocity for the surface heat flux <span class="math inline">\((\overline{w'\theta'})_s\)</span> or between humidity and vertical velocity for the surface moisture flux <span class="math inline">\((\overline{w'q'})_s\)</span>.</p>
<p>Remember that for a generic turbulent variable <span class="math inline">\(\psi\)</span>, Reynolds decomposition yields <span class="math display">\[
\psi = \text{E}[\psi] + \psi' = \overline{\psi} + \psi'
\]</span></p>
<p>with <span class="math inline">\(\text{E}[\psi] = \overline{\psi}\)</span> the averaged value and <span class="math inline">\(\psi'\)</span> the random fluctuating part. In addition with the assumption of no mean vertical wind velocity (<span class="math inline">\(\bar{w} = 0\)</span>, see introductory slides), it follows that:</p>
<p><span class="math display">\[
\begin{split}
\text{cov} [w \psi] = E[(w - \text{E}[w])(\psi - \text{E}[\psi])]  \\
= E[w'\psi'] = \overline{w'\psi'}
\end{split}
\]</span></p>
<section id="task-a-2" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="task-a-2"><span class="header-section-number">1.3.1</span> Task A</h3>
<p>Using measurements from an eddy-covariance sensor given in the Excel file <code>pract1_eddy_cov_data.xls</code>, calculate surface sensible (<span class="math inline">\(H\)</span>) and latent heat (<span class="math inline">\(λE\)</span>) fluxes. Note that latent and sensible heat fluxes are related to the eddy-covariance fluxes by the following relationship (see Theory L3.4):</p>
<p><span class="math display">\[
\begin{split}
H = \rho c_p (\overline{w'\theta'})_s \\
\lambda E = \rho \lambda (\overline{w'q'})_s
\end{split}
\]</span></p>
<p>where <span class="math inline">\(\rho = 1.2\)</span> kg/m<span class="math inline">\(^3\)</span> is the air density and <span class="math inline">\(\lambda = 2.45e6\)</span> J/kg the latent heat of vaporisation.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Use a programming language of your choice to perform the analysis.</p>
</div>
</div>
<!-- For next year, let the students derive this formula of the covariance themselves -->
</section>
</section>
<section id="description-of-the-changes-in-large-scale-atmospheric-forcing" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="description-of-the-changes-in-large-scale-atmospheric-forcing"><span class="header-section-number">1.4</span> Description of the changes in large-scale atmospheric forcing</h2>
<p>With the introductory analysis performed, it is now time to carry out sensitivity experiments with CLASS. For more information on how to use the graphical user interface of CLASS, see <a href="https://ufora.ugent.be/d2l/le/content/1035474/viewContent/2536935/View"><code>CLASS_model_guide.pdf</code></a>. The model parameters are set to be representative of a site in the mid-latitude (approximately 50°N).</p>
<p>As mentioned in the introductory slides, the goal of this practical is to explore what effect the changing synoptic situation over Central Europe, from cyclonic (<span class="math inline">\(C\)</span>, low pressure) to anti-cyclonic (<span class="math inline">\(AC\)</span>, high pressure) – typical for a drought onset conditions - has on the evolution of the ABL state during the day, primarily its (potential) temperature (<span class="math inline">\(\theta\)</span>) and height (<span class="math inline">\(h\)</span>).</p>
<p><a href="#tbl-free_tropo" class="quarto-xref">Table&nbsp;<span>1.2</span></a> and <a href="#fig-cycl_anticycl" class="quarto-xref">Figure&nbsp;<span>1.2</span></a> summarise the change that have occurred in the large-scale atmospheric forcing parameters in the free troposphere: ABL jump (inversion) (<span class="math inline">\(\Delta \theta\)</span> [K]), free tropospheric lapse rate (<span class="math inline">\(\gamma_{\theta}\)</span> [K/m]) and horizontal wind divergence ( <span class="math inline">\(\nabla \cdot \mathbf{u}_h\)</span> [1/s]).</p>
<div id="tbl-free_tropo" class="striped quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-free_tropo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1.2: Observed values for the three large-scale atmospheric forcing parameters for both cyclonic and anti-cyclonic conditions in the free troposphere
</figcaption>
<div aria-describedby="tbl-free_tropo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-striped caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><span class="math inline">\(\Delta \theta\)</span>: ABL jump (inversion) [K]</th>
<th><span class="math inline">\(\gamma_{\theta}\)</span>: Free tropospheric lapse rate [K/m]</th>
<th><span class="math inline">\(\nabla \cdot \mathbf{u}_h\)</span>: Horizontal wind divergence [1/s]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Cyclonic (<span class="math inline">\(C\)</span>)</td>
<td>1.0</td>
<td>0.001</td>
<td>0</td>
</tr>
<tr class="even">
<td>Anti-cyclonic (<span class="math inline">\(AC\)</span>)</td>
<td>4.0</td>
<td>0.009</td>
<td>1e-5</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div id="fig-cycl_anticycl" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cycl_anticycl-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/cyclonic_vs_anticyclonic.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cycl_anticycl-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.2: Sketch of vertical profiles of <span class="math inline">\(\theta\)</span> for both cyclonic and anti-cyclonic conditions
</figcaption>
</figure>
</div>
<p>Before moving to the problems, the three considered governing equations as given in the introductory slides are repeated: <span id="eq-state_theta"><span class="math display">\[
\frac{\partial\left\langle\theta\right\rangle}{\partial t}=\frac{\left(\overline{w^\prime\theta^\prime}\right)_s-\left(\overline{w^\prime\theta^\prime}\right)_e}{h}
\tag{1.2}\]</span></span></p>
<p><span id="eq-state_h"><span class="math display">\[
\frac{\partial h}{\partial t}= -\frac{(\overline{w'\theta'})_e}{\Delta \theta} + w_{s}=w_{e} + w_{s}
\tag{1.3}\]</span></span></p>
<p><span id="eq-state_jump"><span class="math display">\[
\frac{\partial\Delta\theta}{\partial t}=w_{e}\gamma_{\theta}-\frac{\partial\langle\theta\rangle}{\partial t}=\gamma_{\theta}\left(\frac{\partial h}{\partial t}-w_{s}\right)-\frac{\partial\langle\theta\rangle}{\partial t}
\tag{1.4}\]</span></span></p>
<p>When writing down your answers to the problems, please use the equation numbers used above (<a href="#eq-state_theta" class="quarto-xref">Equation&nbsp;<span>1.2</span></a>, <a href="#eq-state_h" class="quarto-xref">Equation&nbsp;<span>1.3</span></a> and <a href="#eq-state_jump" class="quarto-xref">Equation&nbsp;<span>1.4</span></a>) to support your reasoning.</p>
</section>
<section id="sec-problem_4" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="sec-problem_4"><span class="header-section-number">1.5</span> Problem 4</h2>
<p>Start from investigating the influence of a stronger morning contrast between the cooler ABL and warmer free troposphere, i.e.&nbsp;larger morning inversion (<span class="math inline">\(\Delta \theta(t_0) = \Delta \theta_0\)</span>). Note that there is a physical explanation for this larger morning inversion: in anti-cyclonic conditions, clear sky nights typically occur, which results in more cooling (via longwave outgoing radiation) during the night.</p>
<p>Open the interactive window of CLASS model with its initial default set up. Under tab ´Basic´ make sure that only the mixed-layer module is activated; the diurnal cycle of surface fluxes is off, and all the moisture parameters (i.e.&nbsp;<span class="math inline">\(q\)</span>, <span class="math inline">\(\Delta q\)</span>, <span class="math inline">\(\gamma_q\)</span>, <span class="math inline">\(q_{adv}\)</span> and <span class="math inline">\((\overline{w'q'})_s\)</span>) are set to zero for now. See the screen-shot in <a href="#fig-control_exp" class="quarto-xref">Figure&nbsp;<span>1.3</span></a>. This setup is your control experiment.</p>
<div id="fig-control_exp" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-control_exp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/control_experiment.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-control_exp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.3: Control setup of the initial ABL state with activated mixed-layer module, assumption of a dry atmosphere, and constant surface heat flux during the day (i.e.&nbsp;no diurnal cycle)
</figcaption>
</figure>
</div>
<p>Now set up two sensitivity experiments: one for a weak initial nocturnal inversion (experiment <span class="math inline">\(WI\)</span> with the inversion value <span class="math inline">\(\Delta \theta_C\)</span>) and one for a strong initial nocturnal inversion (experiment <span class="math inline">\(SI\)</span> with the inversion value <span class="math inline">\(\Delta \theta_{AC}\)</span>). Use the values from <a href="#tbl-free_tropo" class="quarto-xref">Table&nbsp;<span>1.2</span></a>.</p>
<p>Set up and run both experiments. Use the <code>Graph</code> option in the interactive window to plot and compare the results for the temporal evolution of <span class="math inline">\(h\)</span>, <span class="math inline">\(\langle \theta \rangle\)</span> and <span class="math inline">\(\Delta \theta\)</span>.</p>
<section id="task-a-3" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="task-a-3"><span class="header-section-number">1.5.1</span> Task A</h3>
<p>By analysing the evolution of <span class="math inline">\(\Delta \theta\)</span>, find at which time step (<span class="math inline">\(t_i\)</span>) <span class="math inline">\(\Delta \theta\)</span> starts increasing in the experiments. Describe the differences in the growth rate of <span class="math inline">\(h\)</span> and <span class="math inline">\(\langle \theta \rangle\)</span> before and after this time <span class="math inline">\(t_i\)</span> for both experiments. Use <a href="#eq-state_h" class="quarto-xref">Equation&nbsp;<span>1.3</span></a> and <a href="#eq-state_theta" class="quarto-xref">Equation&nbsp;<span>1.2</span></a> to support your discussion.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Save plots in the <code>Graph</code> interface in order to compare the temporal evolution of ABL variables against each other. Also include the plots later on in your report.</p>
</div>
</div>
</section>
<section id="task-b-1" class="level3" data-number="1.5.2">
<h3 data-number="1.5.2" class="anchored" data-anchor-id="task-b-1"><span class="header-section-number">1.5.2</span> Task B</h3>
<p>Do you have a guess on why <span class="math inline">\(\Delta \theta\)</span> is first decreasing, and then starts increasing? Support your discussion with the dependencies between the variables given by <a href="#eq-state_jump" class="quarto-xref">Equation&nbsp;<span>1.4</span></a>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Exploring vertical profiles of <span class="math inline">\(\langle \theta \rangle\)</span> in <code>Graph</code> interface may help you find the answer.</p>
</div>
</div>
</section>
<section id="sec-feedback" class="level3" data-number="1.5.3">
<h3 data-number="1.5.3" class="anchored" data-anchor-id="sec-feedback"><span class="header-section-number">1.5.3</span> Task C</h3>
<p>Summarise your conclusions about the influence of the larger morning temperature inversion on the evolution of the daytime ABL properties and fill out the feedback diagram in <a href="#fig-feedback_diagram" class="quarto-xref">Figure&nbsp;<span>1.4</span></a> below. Use solid lines with arrows to indicate positive relationships between any two variables, and dashed lines with arrows to show negative relationships. To clarify:</p>
<ul>
<li>Positive relationship between A and B: increase in A leads to increase in</li>
<li>Negative relationship between A and B: decrease in A leads to increase in B</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Look at the 3 main state equations to support the arrows you draw.</p>
</div>
</div>
<div id="fig-feedback_diagram" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-feedback_diagram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TD
  A(["$$\frac{\partial h}{\partial t}$$"])
  B["$$\Delta \theta$$"]
  C["$$\gamma_{\theta}$$"]
  D["$$|w_s|$$"]
  E(["$$\frac{\partial \langle \theta \rangle}{\partial t}$$"])

  A ~~~ B &amp; C &amp; D
  B &amp; C &amp; D ~~~ E

  classDef largeFontSize font-size:22px;
  class A,B,C,D,E largeFontSize;
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-feedback_diagram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.4: Feedback diagram illustrating the effect of large-scale forcing conditions on the evolution of the ABL. In squares, forcing parameters; in round shapes, time derivatives of key state variables.
</figcaption>
</figure>
</div>
</section>
</section>
<section id="sec-problem_5" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="sec-problem_5"><span class="header-section-number">1.6</span> Problem 5</h2>
<p>Another important variable that changed with the onset of the high pressure system (<span class="math inline">\(AC\)</span>) was <span class="math inline">\(\gamma_\theta\)</span>. Under conditions characterized by a high pressure system, warm air is slowly transported downward by subsidence, increasing the stability of the free troposphere, i.e.&nbsp;resulting in larger values of <span class="math inline">\(\gamma_\theta\)</span>.</p>
<p>Using this knowledge, design two experiments to study the influence of larger free-tropospheric lapse rate (higher stability). Using the values provided in <a href="#tbl-free_tropo" class="quarto-xref">Table&nbsp;<span>1.2</span></a>, consider conditions before the onset of an anticyclonic situation (experiment <span class="math inline">\(LO\)</span> with <span class="math inline">\(\gamma_{\theta,C}\)</span>) and another after the onset of a persistent high pressure system (experiment <span class="math inline">\(HI\)</span> <span class="math inline">\(\gamma_{\theta, AC}\)</span>). For the rest, use the same initial set up as in <a href="#sec-problem_4" class="quarto-xref"><span>Section 1.5</span></a>, i.e.&nbsp;no moisture in the ABL and no diurnal cycle for both fluxes. Perform the simulations and compare the evolution of <span class="math inline">\(h\)</span>, <span class="math inline">\(\langle \theta \rangle\)</span>, and <span class="math inline">\(\Delta \theta\)</span> for the two experiments.</p>
<section id="task-a-4" class="level3" data-number="1.6.1">
<h3 data-number="1.6.1" class="anchored" data-anchor-id="task-a-4"><span class="header-section-number">1.6.1</span> Task A</h3>
<p>Using <a href="#eq-state_theta" class="quarto-xref">Equation&nbsp;<span>1.2</span></a>, <a href="#eq-state_h" class="quarto-xref">Equation&nbsp;<span>1.3</span></a> and <a href="#eq-state_jump" class="quarto-xref">Equation&nbsp;<span>1.4</span></a> to support your discussion, analyze the role of <span class="math inline">\(\gamma_\theta\)</span> in the boundary layer growth and temperature evolution.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Study vertical profiles in `Graph´ interface for easier interpretation.</p>
</div>
</div>
</section>
<section id="task-b-2" class="level3" data-number="1.6.2">
<h3 data-number="1.6.2" class="anchored" data-anchor-id="task-b-2"><span class="header-section-number">1.6.2</span> Task B</h3>
<p>Does the effect of stronger morning inversion <span class="math inline">\(\Delta \theta_0\)</span> (from <a href="#sec-problem_4" class="quarto-xref"><span>Section 1.5</span></a>), and larger <span class="math inline">\(\gamma_\theta\)</span> (this exercise), act at similar or different time periods of the day on the evolution of <span class="math inline">\(h\)</span> and <span class="math inline">\(\langle \theta \rangle\)</span>?</p>
</section>
<section id="task-c" class="level3" data-number="1.6.3">
<h3 data-number="1.6.3" class="anchored" data-anchor-id="task-c"><span class="header-section-number">1.6.3</span> Task C</h3>
<p>Summarize the role of <span class="math inline">\(\Delta \theta\)</span> and <span class="math inline">\(\gamma_\theta\)</span> as capping (limiting) factors of the diurnal evolution of the boundary layer. Add these newly identified relationships into the feedback diagram in <a href="#fig-feedback_diagram" class="quarto-xref">Figure&nbsp;<span>1.4</span></a>.</p>
</section>
</section>
<section id="problem-6" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="problem-6"><span class="header-section-number">1.7</span> Problem 6</h2>
<p>Analogously to the experiments in <a href="#sec-problem_4" class="quarto-xref"><span>Section 1.5</span></a> and <a href="#sec-problem_5" class="quarto-xref"><span>Section 1.6</span></a>, explore the sensitivity of the ABL evolution to the strong large-scale atmospheric subsidence <span class="math inline">\(w_s\)</span> developed under high-pressure system (see <a href="#fig-cycl_anticycl" class="quarto-xref">Figure&nbsp;<span>1.2</span></a>). Remember from the introductory slides that <span class="math inline">\(w_s = (\nabla \cdot \mathbf{u}_h) h\)</span>.</p>
<p>Again starting from <a href="#fig-control_exp" class="quarto-xref">Figure&nbsp;<span>1.3</span></a>, set up two experiments: one with zero wind divergence, and another with the divergence given in <a href="#tbl-free_tropo" class="quarto-xref">Table&nbsp;<span>1.2</span></a> for <span class="math inline">\(AC\)</span>. As before, support your answers below with the main state equations.</p>
<section id="task-a-5" class="level3" data-number="1.7.1">
<h3 data-number="1.7.1" class="anchored" data-anchor-id="task-a-5"><span class="header-section-number">1.7.1</span> Task A</h3>
<p>Compare the boundary layer characteristics (<span class="math inline">\(\langle \theta \rangle\)</span>, <span class="math inline">\(h\)</span> and <span class="math inline">\(\Delta \theta\)</span>) in the situation with and without subsidence.</p>
</section>
<section id="task-b-3" class="level3" data-number="1.7.2">
<h3 data-number="1.7.2" class="anchored" data-anchor-id="task-b-3"><span class="header-section-number">1.7.2</span> Task B</h3>
<p>Summarize the effect of subsidence and complete the feedback diagram in <a href="#fig-feedback_diagram" class="quarto-xref">Figure&nbsp;<span>1.4</span></a>.</p>
</section>
</section>
<section id="summary" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="summary"><span class="header-section-number">1.8</span> Summary</h2>
<p>In this first practical, you have investigated the change in large-scale synoptic situation from a cyclonic to anti-cyclonic one, which - if the high pressure system persists - will likely cause a multi-day drought. You identified three main large-scale atmospheric forcing parameters: subsidence (<span class="math inline">\(w_s\)</span>), inversion (<span class="math inline">\(\Delta \theta\)</span>) and atmospheric stability (as determined by <span class="math inline">\(\gamma_\theta\)</span>), which have changed alongside the onset of the high pressure system. These factors will definitely influence daytime dynamics of the ABL, and in the long run, rainfall occurrence, surface water availability, temperature peaks and ecosystem productivity.</p>
<p>Examine one more time the feedback diagram (<a href="#fig-feedback_diagram" class="quarto-xref">Figure&nbsp;<span>1.4</span></a>) you worked upon, and summarize the expected change in the ABL dynamics due to the established large-scale synoptic situation.</p>
<section id="task-a-6" class="level3" data-number="1.8.1">
<h3 data-number="1.8.1" class="anchored" data-anchor-id="task-a-6"><span class="header-section-number">1.8.1</span> Task A</h3>
<p>What is the common effect of the changed large-scale forcing conditions on ABL growth? And on temperature?</p>
</section>
<section id="task-b-4" class="level3" data-number="1.8.2">
<h3 data-number="1.8.2" class="anchored" data-anchor-id="task-b-4"><span class="header-section-number">1.8.2</span> Task B</h3>
<p>We did not look specifically into the effect of clear sky conditions (typical for anti-cyclone) versus cloudy weather (typical for cyclone) on the evolution of the ABL height and temperature. Do you expect the change to a clear sky conditions to have a positive or negative effect on ABL growth and temperature? Why?</p>
<!-- ::: {.content-visible unless-profile="student"}
This content will appear ONLY if you don't render with the student version
::: -->


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Shuttleworh_terrestrial_hydromet" class="csl-entry" role="listitem">
Shuttleworh, W. James. 2012. <span>“Vertical Gradients in the Atmosphere.”</span> In <em>Terrestrial Hydrometeorology</em>, 25–35. John Wiley &amp; Sons, Ltd. <a href="https://doi.org/10.1002/9781119951933.ch3">https://doi.org/10.1002/9781119951933.ch3</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Preface">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./practical_2.html" class="pagination-link" aria-label="Practical 2: Role of land state and vegetation">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Practical 2: Role of land state and vegetation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>